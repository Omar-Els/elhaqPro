# نظام الكشفات - دعوة الحق

## نظرة عامة

تم تطوير نظام كشفات متكامل لإدارة المستفيدين في مؤسسة دعوة الحق. هذا النظام يسمح بإنشاء كشفات مختلفة وتنظيم المستفيدين ضمن هذه الكشفات بطريقة منظمة وفعالة.

## المميزات الرئيسية

### 1. إدارة الكشفات
- **إنشاء كشفات جديدة**: يمكن إنشاء كشفات بأسماء ووصف مخصص
- **تعديل الكشفات**: إمكانية تعديل اسم ووصف الكشف
- **حذف الكشفات**: إزالة الكشفات غير المطلوبة
- **عرض إحصائيات الكشف**: عدد المستفيدين في كل كشف

### 2. ربط المستفيدين بالكشفات
- **إضافة مستفيدين للكشف**: عند إضافة مستفيد جديد، يمكن اختيار الكشف مباشرة
- **إزالة مستفيدين من الكشف**: إمكانية إزالة مستفيد من كشف معين
- **عرض المستفيدين في الكشف**: عرض قائمة المستفيدين في كل كشف

### 3. واجهة مستخدم متقدمة
- **تصميم متجاوب**: يعمل على جميع الأجهزة
- **بحث وفلترة**: البحث في الكشفات وفلترة حسب الحالة
- **إحصائيات مرئية**: عرض إحصائيات الكشفات بشكل واضح

## كيفية الاستخدام

### إنشاء كشف جديد
1. انتقل إلى صفحة "الكشفات" من القائمة الرئيسية
2. اضغط على زر "إنشاء كشف جديد"
3. أدخل اسم الكشف ووصفه (اختياري)
4. اضغط "إنشاء الكشف"

### إضافة مستفيد لكشف
1. عند إضافة مستفيد جديد، ستجد حقل "الكشف" في النموذج
2. اختر الكشف المناسب من القائمة المنسدلة
3. أكمل باقي بيانات المستفيد
4. عند الحفظ، سيتم إضافة المستفيد تلقائياً للكشف المحدد

### إدارة المستفيدين في الكشف
1. في صفحة الكشفات، ستجد قائمة بجميع الكشفات
2. لكل كشف، يمكنك:
   - إضافة مستفيدين جدد
   - إزالة مستفيدين من الكشف
   - تعديل بيانات الكشف
   - حذف الكشف

## البنية التقنية

### الملفات الرئيسية
- `src/features/sheets/sheetsSlice.js` - إدارة حالة الكشفات
- `src/components/SheetsManager.jsx` - مكون إدارة الكشفات
- `src/pages/Sheets.jsx` - صفحة الكشفات
- `src/components/BeneficiaryForm.jsx` - نموذج إضافة المستفيد (محدث)

### هيكل البيانات
```javascript
// كشف
{
  id: "SHEET-1234567890-123",
  name: "كشف رمضان 2024",
  description: "كشف المستفيدين لشهر رمضان",
  beneficiaries: [], // قائمة المستفيدين
  createdAt: "2024-01-01T00:00:00.000Z",
  updatedAt: "2024-01-01T00:00:00.000Z",
  status: "active",
  totalAmount: 0,
  beneficiaryCount: 0
}

// مستفيد (محدث)
{
  // ... البيانات الأساسية
  sheetId: "SHEET-1234567890-123" // معرف الكشف
}
```

## الصلاحيات المطلوبة

- `BENEFICIARIES_VIEW` - عرض الكشفات
- `BENEFICIARIES_CREATE` - إنشاء كشفات جديدة
- `BENEFICIARIES_EDIT` - تعديل الكشفات
- `BENEFICIARIES_DELETE` - حذف الكشفات

## التخزين

### IndexedDB (الأولوية)
- يتم حفظ الكشفات في IndexedDB للحصول على مساحة تخزين أكبر
- دعم للعمل بدون اتصال بالإنترنت

### localStorage (النسخة الاحتياطية)
- إذا فشل IndexedDB، يتم استخدام localStorage
- ترحيل تلقائي من localStorage إلى IndexedDB

## المزامنة

- يتم تحديد الكشفات للمزامنة السحابية
- دعم للمزامنة مع MongoDB عند توفر الاتصال

## التطوير المستقبلي

### الميزات المخطط لها
1. **طباعة الكشفات**: إمكانية طباعة الكشفات بصيغة PDF
2. **تصدير البيانات**: تصدير بيانات الكشفات بصيغ مختلفة
3. **إحصائيات متقدمة**: رسوم بيانية وإحصائيات مفصلة
4. **تنبيهات الكشفات**: إشعارات عند إضافة مستفيدين للكشف
5. **تاريخ الكشفات**: تتبع التغييرات في الكشفات

### التحسينات التقنية
1. **أداء محسن**: تحسين سرعة تحميل الكشفات الكبيرة
2. **بحث متقدم**: بحث في محتوى الكشفات
3. **فلترة متقدمة**: فلترة حسب تاريخ الإنشاء، الحالة، إلخ
4. **تصدير/استيراد**: إمكانية تصدير واستيراد الكشفات

## الدعم والمساعدة

إذا واجهت أي مشاكل أو لديك استفسارات حول نظام الكشفات، يمكنك:

1. مراجعة هذا الدليل
2. التواصل مع فريق التطوير
3. مراجعة سجلات الأخطاء في وحدة تحكم المتصفح

---

**تم تطوير هذا النظام بواسطة فريق دعوة الحق**
**آخر تحديث: يناير 2024** 