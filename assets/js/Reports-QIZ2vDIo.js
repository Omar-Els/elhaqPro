import{j as e,m as x}from"./ui-4y8eivj0.js";import{r as j}from"./router-CLq98pCg.js";import{u as w,e as m}from"./redux-Bcoi-VAn.js";import{K as k,Q as M,R as B,H as R,aI as g,aJ as F,aK as y,au as C,P as _}from"./index-B-68B3Uo.js";import"./vendor-CWc6w16D.js";const J=()=>{const[i,v]=j.useState("initiatives"),[d,T]=j.useState(new Date().getFullYear()),[c,Y]=j.useState(null),[t,A]=j.useState("bar");w();const S=m(k),E=m(M);m(B);const o=m(R),n=S.filter(s=>{const a=new Date(s.date),l=a.getFullYear(),f=a.getMonth();return c===null?l===d:l===d&&f===c}),h=E.filter(s=>{const a=new Date(s.date),l=a.getFullYear(),f=a.getMonth();return c===null?l===d:l===d&&f===c}),u={total:n.length,totalBeneficiaries:n.reduce((s,a)=>{var l;return s+(((l=a.beneficiaries)==null?void 0:l.length)||0)},0),totalAmount:n.reduce((s,a)=>s+(parseFloat(a.totalAmount)||0),0)},r={totalIncome:h.filter(s=>s.type==="income").reduce((s,a)=>s+parseFloat(a.amount),0),totalExpenses:h.filter(s=>s.type==="expense").reduce((s,a)=>s+parseFloat(a.amount),0),balance:0};r.balance=r.totalIncome-r.totalExpenses;const p=Array.from(new Set([...S.map(s=>new Date(s.date).getFullYear()),...E.map(s=>new Date(s.date).getFullYear())])).sort((s,a)=>a-s);p.length===0&&p.push(new Date().getFullYear());const D=[{value:0,label:"يناير"},{value:1,label:"فبراير"},{value:2,label:"مارس"},{value:3,label:"أبريل"},{value:4,label:"مايو"},{value:5,label:"يونيو"},{value:6,label:"يوليو"},{value:7,label:"أغسطس"},{value:8,label:"سبتمبر"},{value:9,label:"أكتوبر"},{value:10,label:"نوفمبر"},{value:11,label:"ديسمبر"}],I={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},N={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},b=(s,a)=>{_(s,a)};return e.jsxs(x.div,{className:"reports-container",variants:I,initial:"hidden",animate:"visible",children:[e.jsx(x.div,{className:"page-header",variants:N,children:e.jsx("h1",{children:"التقارير والإحصائيات"})}),e.jsxs(x.div,{className:"filters-container",variants:N,children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"year",children:"السنة"}),e.jsx("select",{id:"year",value:d,onChange:s=>T(parseInt(s.target.value)),children:p.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"month",children:"الشهر"}),e.jsxs("select",{id:"month",value:c===null?"":c,onChange:s=>Y(s.target.value===""?null:parseInt(s.target.value)),children:[e.jsx("option",{value:"",children:"كل الشهور"}),D.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"chartType",children:"نوع الرسم البياني"}),e.jsxs("select",{id:"chartType",value:t,onChange:s=>A(s.target.value),children:[e.jsx("option",{value:"bar",children:"أعمدة"}),e.jsx("option",{value:"pie",children:"دائري"}),e.jsx("option",{value:"line",children:"خطي"})]})]})]}),e.jsxs(x.div,{className:"tabs-container",variants:N,children:[e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:`tab-btn ${i==="initiatives"?"active":""}`,onClick:()=>v("initiatives"),children:"تقارير المبادرات"}),e.jsx("button",{className:`tab-btn ${i==="finances"?"active":""}`,onClick:()=>v("finances"),children:"تقارير الماليات"}),e.jsx("button",{className:`tab-btn ${i==="beneficiaries"?"active":""}`,onClick:()=>v("beneficiaries"),children:"تقارير المستفيدين"})]}),e.jsxs("div",{className:"tab-content",children:[i==="initiatives"&&e.jsxs("div",{className:"initiatives-report",children:[e.jsxs("div",{className:"report-header",children:[e.jsx("h2",{children:"تقارير المبادرات"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>b(n,"تقرير_المبادرات"),children:[e.jsx(g,{})," تصدير إلى Excel"]})]}),e.jsxs("div",{className:"stats-cards",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-title",children:"عدد المبادرات"}),e.jsx("div",{className:"stat-value",children:u.total})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-title",children:"عدد المستفيدين"}),e.jsx("div",{className:"stat-value",children:u.totalBeneficiaries})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-title",children:"إجمالي المبالغ"}),e.jsxs("div",{className:"stat-value",children:[u.totalAmount.toFixed(2)," جنيه"]})]})]}),e.jsx("div",{className:"chart-container",children:e.jsxs("div",{className:"chart-placeholder",children:[t==="bar"&&e.jsx(F,{className:"chart-icon"}),t==="pie"&&e.jsx(y,{className:"chart-icon"}),t==="line"&&e.jsx(C,{className:"chart-icon"}),e.jsx("p",{children:"الرسم البياني للمبادرات"})]})}),e.jsxs("div",{className:"data-table",children:[e.jsx("h3",{children:"قائمة المبادرات"}),n.length>0?e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"اسم المبادرة"}),e.jsx("th",{children:"التاريخ"}),e.jsx("th",{children:"عدد المستفيدين"}),e.jsx("th",{children:"إجمالي المبلغ"})]})}),e.jsx("tbody",{children:n.map(s=>{var a;return e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.date}),e.jsx("td",{children:((a=s.beneficiaries)==null?void 0:a.length)||0}),e.jsxs("td",{children:[parseFloat(s.totalAmount||0).toFixed(2)," جنيه"]})]},s.id)})})]}):e.jsx("p",{className:"no-data",children:"لا توجد بيانات للعرض"})]})]}),i==="finances"&&e.jsxs("div",{className:"finances-report",children:[e.jsxs("div",{className:"report-header",children:[e.jsx("h2",{children:"تقارير الماليات"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>b(h,"تقرير_الماليات"),children:[e.jsx(g,{})," تصدير إلى Excel"]})]}),e.jsxs("div",{className:"stats-cards",children:[e.jsxs("div",{className:"stat-card income",children:[e.jsx("div",{className:"stat-title",children:"إجمالي الإيرادات"}),e.jsxs("div",{className:"stat-value",children:[r.totalIncome.toFixed(2)," جنيه"]})]}),e.jsxs("div",{className:"stat-card expense",children:[e.jsx("div",{className:"stat-title",children:"إجمالي المصروفات"}),e.jsxs("div",{className:"stat-value",children:[r.totalExpenses.toFixed(2)," جنيه"]})]}),e.jsxs("div",{className:"stat-card balance",children:[e.jsx("div",{className:"stat-title",children:"الرصيد"}),e.jsxs("div",{className:"stat-value",children:[r.balance.toFixed(2)," جنيه"]})]})]}),e.jsx("div",{className:"chart-container",children:e.jsxs("div",{className:"chart-placeholder",children:[t==="bar"&&e.jsx(F,{className:"chart-icon"}),t==="pie"&&e.jsx(y,{className:"chart-icon"}),t==="line"&&e.jsx(C,{className:"chart-icon"}),e.jsx("p",{children:"الرسم البياني للماليات"})]})}),e.jsxs("div",{className:"data-table",children:[e.jsx("h3",{children:"قائمة المعاملات المالية"}),h.length>0?e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"التاريخ"}),e.jsx("th",{children:"النوع"}),e.jsx("th",{children:"الوصف"}),e.jsx("th",{children:"المبلغ"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.date}),e.jsx("td",{children:s.type==="income"?"إيراد":"مصروف"}),e.jsx("td",{children:s.description}),e.jsxs("td",{className:s.type==="income"?"income-amount":"expense-amount",children:[parseFloat(s.amount).toFixed(2)," جنيه"]})]},s.id))})]}):e.jsx("p",{className:"no-data",children:"لا توجد بيانات للعرض"})]})]}),i==="beneficiaries"&&e.jsxs("div",{className:"beneficiaries-report",children:[e.jsxs("div",{className:"report-header",children:[e.jsx("h2",{children:"تقارير المستفيدين"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>b(o,"تقرير_المستفيدين"),children:[e.jsx(g,{})," تصدير إلى Excel"]})]}),e.jsxs("div",{className:"stats-cards",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-title",children:"عدد المستفيدين"}),e.jsx("div",{className:"stat-value",children:o.length})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-title",children:"عدد الأسر"}),e.jsx("div",{className:"stat-value",children:o.filter(s=>s.maritalStatus==="married").length})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-title",children:"عدد الأفراد"}),e.jsx("div",{className:"stat-value",children:o.filter(s=>s.maritalStatus!=="married").length})]})]}),e.jsx("div",{className:"chart-container",children:e.jsxs("div",{className:"chart-placeholder",children:[t==="bar"&&e.jsx(F,{className:"chart-icon"}),t==="pie"&&e.jsx(y,{className:"chart-icon"}),t==="line"&&e.jsx(C,{className:"chart-icon"}),e.jsx("p",{children:"الرسم البياني للمستفيدين"})]})})]})]})]})]})};export{J as default};
