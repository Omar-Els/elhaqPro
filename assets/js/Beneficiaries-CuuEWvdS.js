import{j as s,m as a}from"./ui-DdfHXWzg.js";import{r as t}from"./router-Bz2IGiOt.js";import{u as A,e as T}from"./redux-CWL_9H02.js";import{H as M,an as o,V as f,bq as k,br as R,bB as P,k as _,ae as L,p as U,q as z,aa as H,Z as V,_ as q}from"./index-COkUExVb.js";import{u as G,P as h,a as m}from"./usePermissions-6gA7g22n.js";import"./vendor-BDC5HmX-.js";const is=()=>{A(),G();const c=T(M),[i,b]=t.useState(""),[n,E]=t.useState("all"),x=c.filter(e=>{var p,u,N;const r=!i||((p=e.name)==null?void 0:p.toLowerCase().includes(i.toLowerCase()))||((u=e.nationalId)==null?void 0:u.includes(i))||((N=e.phone)==null?void 0:N.includes(i)),D=n==="all"||n==="active"&&e.status==="active"||n==="inactive"&&e.status==="inactive"||n==="recent"&&new Date(e.createdAt)>new Date(Date.now()-7*24*60*60*1e3);return r&&D}),d={total:c.length,active:c.filter(e=>e.status==="active").length,inactive:c.filter(e=>e.status==="inactive").length,totalFamilyMembers:c.reduce((e,r)=>e+(r.familySize||1),0)},[$,j]=t.useState(!1),[O,S]=t.useState(!1),[Z,v]=t.useState(null),[J,y]=t.useState(!1),[K,C]=t.useState(null),[Q,F]=t.useState(!1),[W,w]=t.useState({name:"",nationalId:"",phone:"",address:"",familySize:1,monthlyIncome:0,needsDescription:"",status:"active",children:[],notes:""});t.useEffect(()=>{},[]);const I=e=>{v(e),w(e),S(!0)},g=e=>{v(e),F(!0)},B={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},l={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return s.jsxs(a.div,{className:"beneficiaries-container",variants:B,initial:"hidden",animate:"visible",children:[s.jsxs(a.div,{className:"page-header",variants:l,children:[s.jsxs("div",{className:"header-content",children:[s.jsxs("div",{className:"header-text",children:[s.jsxs("h1",{children:[s.jsx(o,{className:"page-icon"}),"المستفيدون"]}),s.jsx("p",{children:"إدارة بيانات المستفيدين من خدمات المؤسسة"})]}),s.jsx(h,{permission:m.BENEFICIARIES_CREATE,children:s.jsxs(a.button,{className:"btn btn-primary add-btn",onClick:()=>j(!0),whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(f,{}),"إضافة مستفيد"]})})]}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs(a.div,{className:"stat-card total",variants:l,children:[s.jsx("div",{className:"stat-icon",children:s.jsx(o,{})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:d.total}),s.jsx("p",{children:"إجمالي المستفيدين"})]})]}),s.jsxs(a.div,{className:"stat-card active",variants:l,children:[s.jsx("div",{className:"stat-icon",children:s.jsx(k,{})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:d.active}),s.jsx("p",{children:"مستفيدون نشطون"})]})]}),s.jsxs(a.div,{className:"stat-card inactive",variants:l,children:[s.jsx("div",{className:"stat-icon",children:s.jsx(R,{})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:d.inactive}),s.jsx("p",{children:"مستفيدون غير نشطين"})]})]}),s.jsxs(a.div,{className:"stat-card families",variants:l,children:[s.jsx("div",{className:"stat-icon",children:s.jsx(P,{})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:d.totalFamilyMembers}),s.jsx("p",{children:"إجمالي أفراد الأسر"})]})]})]})]}),s.jsx(a.div,{className:"controls-section",variants:l,children:s.jsxs("div",{className:"search-filter-container",children:[s.jsxs("div",{className:"search-box",children:[s.jsx(_,{className:"search-icon"}),s.jsx("input",{type:"text",id:"beneficiaries-search",name:"beneficiaries-search",placeholder:"البحث في المستفيدين...",value:i,onChange:e=>b(e.target.value),autoComplete:"off"})]}),s.jsx("div",{className:"filter-controls",children:s.jsxs("select",{id:"beneficiaries-filter",name:"beneficiaries-filter",value:n,onChange:e=>E(e.target.value),className:"filter-select",children:[s.jsx("option",{value:"all",children:"جميع المستفيدين"}),s.jsx("option",{value:"active",children:"نشطون"}),s.jsx("option",{value:"inactive",children:"غير نشطين"}),s.jsx("option",{value:"recent",children:"مضافون حديثاً"})]})})]})}),s.jsx(a.div,{className:"beneficiaries-content",variants:l,children:x.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx(o,{className:"empty-icon"}),s.jsx("h3",{children:"لا يوجد مستفيدون"}),s.jsx("p",{children:i||n!=="all"?"لا توجد نتائج تطابق البحث أو الفلتر المحدد":"ابدأ بإضافة مستفيدين جدد للمؤسسة"}),!i&&n==="all"&&s.jsx(h,{permission:m.BENEFICIARIES_CREATE,children:s.jsxs("button",{className:"btn btn-primary",onClick:()=>j(!0),children:[s.jsx(f,{}),"إضافة أول مستفيد"]})})]}):s.jsx("div",{className:"beneficiaries-grid",children:x.map((e,r)=>s.jsxs(a.div,{className:`beneficiary-card ${e.status}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},whileHover:{y:-5,boxShadow:"0 8px 25px rgba(0,0,0,0.15)"},children:[s.jsxs("div",{className:"beneficiary-header",children:[s.jsx("div",{className:"beneficiary-avatar",children:e.name.charAt(0).toUpperCase()}),s.jsxs("div",{className:"beneficiary-info",children:[s.jsx("h3",{children:e.name}),s.jsxs("p",{className:"beneficiary-id",children:["الرقم القومي: ",e.nationalId]}),s.jsx("span",{className:`status-badge ${e.status}`,children:e.status==="active"?"نشط":"غير نشط"})]})]}),s.jsxs("div",{className:"beneficiary-details",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx(L,{}),s.jsx("span",{children:e.phone})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx(o,{}),s.jsxs("span",{children:["حجم الأسرة: ",e.familySize]})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx(U,{}),s.jsx("span",{children:e.address||"غير محدد"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx(z,{}),s.jsxs("span",{children:["مضاف في ",new Date(e.createdAt).toLocaleDateString("ar-EG")]})]})]}),s.jsxs("div",{className:"beneficiary-actions",children:[s.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>g(e),title:"عرض التفاصيل",children:s.jsx(H,{})}),s.jsx(h,{permission:m.BENEFICIARIES_EDIT,children:s.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>I(e),title:"تعديل",children:s.jsx(V,{})})}),s.jsx(h,{permission:m.BENEFICIARIES_DELETE,children:s.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{C(e),y(!0)},title:"حذف",children:s.jsx(q,{})})})]})]},e.id))})})]})};export{is as default};
