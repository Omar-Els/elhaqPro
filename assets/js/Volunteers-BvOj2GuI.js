import{j as e,m as i,A as N}from"./ui-4y8eivj0.js";import{r as c}from"./router-CLq98pCg.js";import{u as Q,e as b}from"./redux-Bcoi-VAn.js";import{bj as W,bk as X,bl as Y,bm as ee,bn as se,bo as ae,bp as le,an as w,aF as C,bq as ie,br as ne,k as te,bs as re,bt as ce,af as O,ae as _,q,aa as oe,Z as k,_ as M,p as de,ba as m,bu as me,bv as he,bw as xe}from"./index-B-68B3Uo.js";import{u as je,P as f,a as h}from"./usePermissions-CIdXrF5J.js";import"./vendor-CWc6w16D.js";const Ce=()=>{const t=Q(),{hasPermission:E}=je(),A=b(W),F=b(X),y=b(Y),S=b(ee),V=b(se),[B,j]=c.useState(!1),[L,o]=c.useState(!1),[l,D]=c.useState(null),[G,u]=c.useState(!1),[T,U]=c.useState(null),[pe,ue]=c.useState([]),[H,v]=c.useState(!1),[a,g]=c.useState({name:"",email:"",phone:"",nationalId:"",address:"",birthDate:"",gender:"male",qualification:"",job:"",department:"",skills:"",experience:"",availability:"part-time",emergencyContact:{name:"",phone:"",relation:""},notes:""});c.useEffect(()=>{t(ae())},[t]),c.useEffect(()=>{F.length>0&&t(le())},[F,t]);const $=s=>{if(s.preventDefault(),!E(h.VOLUNTEERS_CREATE)){t(m({type:"error",message:"ليس لديك صلاحية لإضافة متطوعين"}));return}if(!a.name||!a.email||!a.phone||!a.department||!a.qualification){t(m({type:"error",message:"يرجى ملء جميع الحقول المطلوبة"}));return}if(F.some(d=>d.email===a.email)){t(m({type:"error",message:"البريد الإلكتروني مستخدم بالفعل"}));return}const p=a.skills.split(",").map(d=>d.trim()).filter(Boolean);t(xe({...a,skills:p,status:"active"})),t(m({type:"success",message:"تم إضافة المتطوع بنجاح"})),g({name:"",email:"",phone:"",nationalId:"",address:"",birthDate:"",gender:"male",qualification:"",job:"",department:"",skills:"",experience:"",availability:"part-time",emergencyContact:{name:"",phone:"",relation:""},notes:""}),j(!1)},P=s=>{if(s.preventDefault(),!E(h.VOLUNTEERS_EDIT)){t(m({type:"error",message:"ليس لديك صلاحية لتعديل المتطوعين"}));return}const r=typeof a.skills=="string"?a.skills.split(",").map(p=>p.trim()).filter(Boolean):a.skills;t(me({id:l.id,...a,skills:r})),t(m({type:"success",message:"تم تحديث بيانات المتطوع بنجاح"})),o(!1),D(null)},Z=()=>{if(!E(h.VOLUNTEERS_DELETE)){t(m({type:"error",message:"ليس لديك صلاحية لحذف المتطوعين"}));return}t(he(T.id)),t(m({type:"success",message:"تم حذف المتطوع بنجاح"})),u(!1),U(null)},R=s=>{D(s),g({...s,skills:Array.isArray(s.skills)?s.skills.join(", "):s.skills||""}),o(!0)},z=s=>{D(s),v(!0)},n=s=>{const{name:r,value:p}=s.target;if(r.includes(".")){const[d,K]=r.split(".");g(I=>({...I,[d]:{...I[d],[K]:p}}))}else g(d=>({...d,[r]:p}))},J={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},x={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs(i.div,{className:"volunteers-container",variants:J,initial:"hidden",animate:"visible",children:[e.jsxs(i.div,{className:"page-header",variants:x,children:[e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-text",children:[e.jsxs("h1",{children:[e.jsx(w,{className:"page-icon"}),"المتطوعون"]}),e.jsx("p",{children:"إدارة بيانات المتطوعين والمساعدين في المؤسسة"})]}),e.jsx(f,{permission:h.VOLUNTEERS_CREATE,children:e.jsxs(i.button,{className:"btn btn-primary add-btn",onClick:()=>j(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"إضافة متطوع جديد للمؤسسة",children:[e.jsx(C,{}),"إضافة متطوع جديد"]})})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs(i.div,{className:"stat-card total",variants:x,children:[e.jsx("div",{className:"stat-icon",children:e.jsx(w,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:y.total}),e.jsx("p",{children:"إجمالي المتطوعين"})]})]}),e.jsxs(i.div,{className:"stat-card active",variants:x,children:[e.jsx("div",{className:"stat-icon",children:e.jsx(ie,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:y.active}),e.jsx("p",{children:"متطوعون نشطون"})]})]}),e.jsxs(i.div,{className:"stat-card inactive",variants:x,children:[e.jsx("div",{className:"stat-icon",children:e.jsx(ne,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:y.inactive}),e.jsx("p",{children:"متطوعون غير نشطين"})]})]}),e.jsxs(i.div,{className:"stat-card new",variants:x,children:[e.jsx("div",{className:"stat-icon",children:e.jsx(C,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:y.new}),e.jsx("p",{children:"متطوعون جدد"})]})]})]})]}),e.jsx(i.div,{className:"controls-section",variants:x,children:e.jsxs("div",{className:"search-filter-container",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(te,{className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"البحث في المتطوعين...",value:S,onChange:s=>t(re(s.target.value))})]}),e.jsx("div",{className:"filter-controls",children:e.jsxs("select",{value:V,onChange:s=>t(ce(s.target.value)),className:"filter-select",children:[e.jsx("option",{value:"all",children:"جميع المتطوعين"}),e.jsx("option",{value:"active",children:"نشطون"}),e.jsx("option",{value:"inactive",children:"غير نشطين"}),e.jsx("option",{value:"new",children:"جدد"})]})})]})}),e.jsx(i.div,{className:"volunteers-content",variants:x,children:A.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(w,{className:"empty-icon"}),e.jsx("h3",{children:"لا يوجد متطوعون"}),e.jsx("p",{children:S||V!=="all"?"لا توجد نتائج تطابق البحث أو الفلتر المحدد":"ابدأ بإضافة متطوعين جدد للمؤسسة"}),!S&&V==="all"&&e.jsx(f,{permission:h.VOLUNTEERS_CREATE,children:e.jsxs(i.button,{className:"btn btn-primary add-btn",onClick:()=>j(!0),whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(C,{}),"إضافة أول متطوع"]})})]}):e.jsx("div",{className:"volunteers-grid",children:A.map((s,r)=>e.jsxs(i.div,{className:`volunteer-card ${s.status}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},whileHover:{y:-5,boxShadow:"0 8px 25px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{className:"volunteer-header",children:[e.jsx("div",{className:"volunteer-avatar",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"volunteer-info",children:[e.jsx("h3",{children:s.name}),e.jsx("p",{className:"volunteer-department",children:s.department}),e.jsx("span",{className:`status-badge ${s.status}`,children:s.status==="active"?"نشط":"غير نشط"})]})]}),e.jsxs("div",{className:"volunteer-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx(O,{}),e.jsx("span",{children:s.email})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(_,{}),e.jsx("span",{children:s.phone})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(q,{}),e.jsxs("span",{children:["انضم في ",new Date(s.joinDate).toLocaleDateString("ar-EG")]})]})]}),e.jsxs("div",{className:"volunteer-actions",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>z(s),title:"عرض التفاصيل",children:e.jsx(oe,{})}),e.jsx(f,{permission:h.VOLUNTEERS_EDIT,children:e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>R(s),title:"تعديل",children:e.jsx(k,{})})}),e.jsx(f,{permission:h.VOLUNTEERS_DELETE,children:e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{U(s),u(!0)},title:"حذف",children:e.jsx(M,{})})})]})]},s.id))})}),e.jsx(N,{children:L&&l&&e.jsx(i.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>o(!1),children:e.jsxs(i.div,{className:"modal-content volunteer-modal",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"تعديل بيانات المتطوع"}),e.jsx("button",{className:"close-btn",onClick:()=>o(!1),children:"✕"})]}),e.jsxs("form",{className:"volunteer-form",onSubmit:s=>{s.preventDefault(),P()},children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-name",children:"الاسم الكامل *"}),e.jsx("input",{type:"text",id:"edit-name",name:"name",value:a.name,onChange:n,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-email",children:"البريد الإلكتروني *"}),e.jsx("input",{type:"email",id:"edit-email",name:"email",value:a.email,onChange:n,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-phone",children:"رقم الهاتف *"}),e.jsx("input",{type:"tel",id:"edit-phone",name:"phone",value:a.phone,onChange:n,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-status",children:"الحالة"}),e.jsxs("select",{id:"edit-status",name:"status",value:a.status,onChange:n,children:[e.jsx("option",{value:"active",children:"نشط"}),e.jsx("option",{value:"inactive",children:"غير نشط"})]})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>o(!1),children:"إلغاء"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx(k,{}),"حفظ التغييرات"]})]})]})]})})}),e.jsx(N,{children:G&&T&&e.jsx(i.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>u(!1),children:e.jsxs(i.div,{className:"modal-content delete-modal",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"تأكيد الحذف"}),e.jsx("button",{className:"close-btn",onClick:()=>u(!1),children:"✕"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["هل أنت متأكد من حذف المتطوع ",e.jsx("strong",{children:T.name}),"؟"]}),e.jsx("p",{className:"warning-text",children:"لا يمكن التراجع عن هذا الإجراء."})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>u(!1),children:"إلغاء"}),e.jsxs("button",{className:"btn btn-danger",onClick:Z,children:[e.jsx(M,{}),"حذف المتطوع"]})]})]})})}),e.jsx(N,{children:H&&l&&e.jsx(i.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>v(!1),children:e.jsxs(i.div,{className:"modal-content details-modal",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"تفاصيل المتطوع"}),e.jsx("button",{className:"close-btn",onClick:()=>v(!1),children:"✕"})]}),e.jsxs("div",{className:"volunteer-details-content",children:[e.jsxs("div",{className:"volunteer-profile",children:[e.jsx("div",{className:"profile-avatar",children:l.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"profile-info",children:[e.jsx("h3",{children:l.name}),e.jsx("p",{children:l.department}),e.jsx("span",{className:`status-badge ${l.status}`,children:l.status==="active"?"نشط":"غير نشط"})]})]}),e.jsxs("div",{className:"details-grid",children:[e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"معلومات الاتصال"}),e.jsxs("div",{className:"detail-item",children:[e.jsx(O,{}),e.jsx("span",{children:l.email})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(_,{}),e.jsx("span",{children:l.phone})]}),l.address&&e.jsxs("div",{className:"detail-item",children:[e.jsx(de,{}),e.jsx("span",{children:l.address})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"معلومات شخصية"}),e.jsx("div",{className:"detail-item",children:e.jsxs("span",{children:["الجنس: ",l.gender==="male"?"ذكر":"أنثى"]})}),l.birthDate&&e.jsxs("div",{className:"detail-item",children:[e.jsx(q,{}),e.jsxs("span",{children:["تاريخ الميلاد: ",new Date(l.birthDate).toLocaleDateString("ar-EG")]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(q,{}),e.jsxs("span",{children:["تاريخ الانضمام: ",new Date(l.joinDate).toLocaleDateString("ar-EG")]})]})]}),l.skills&&l.skills.length>0&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"المهارات"}),e.jsx("div",{className:"skills-list",children:l.skills.map((s,r)=>e.jsx("span",{className:"skill-tag",children:s},r))})]}),l.notes&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"ملاحظات"}),e.jsx("p",{children:l.notes})]})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"إغلاق"}),e.jsx(f,{permission:h.VOLUNTEERS_EDIT,children:e.jsxs("button",{className:"btn btn-primary",onClick:()=>{v(!1),R(l)},children:[e.jsx(k,{}),"تعديل"]})})]})]})})}),e.jsx(N,{children:B&&e.jsx(i.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>j(!1),children:e.jsxs(i.div,{className:"modal-content volunteer-form-modal",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:[e.jsx(C,{}),"إضافة متطوع جديد"]}),e.jsx("button",{className:"close-btn",onClick:()=>j(!1),children:e.jsx(FaTimes,{})})]}),e.jsxs("form",{onSubmit:$,className:"volunteer-form",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"البيانات الشخصية"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"الاسم الكامل *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:n,required:!0,placeholder:"أدخل الاسم الكامل"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"البريد الإلكتروني *"}),e.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:n,required:!0,placeholder:"example@email.com"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone",children:"رقم الهاتف *"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:a.phone,onChange:n,required:!0,placeholder:"01234567890"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nationalId",children:"الرقم القومي"}),e.jsx("input",{type:"text",id:"nationalId",name:"nationalId",value:a.nationalId,onChange:n,placeholder:"14 رقم",maxLength:"14"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"address",children:"العنوان"}),e.jsx("textarea",{id:"address",name:"address",value:a.address,onChange:n,rows:"2",placeholder:"أدخل العنوان"})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"المؤهلات والوظيفة"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"qualification",children:"المؤهل التعليمي *"}),e.jsxs("select",{id:"qualification",name:"qualification",value:a.qualification,onChange:n,required:!0,children:[e.jsx("option",{value:"",children:"اختر المؤهل"}),e.jsx("option",{value:"high-school",children:"ثانوية عامة"}),e.jsx("option",{value:"diploma",children:"دبلوم"}),e.jsx("option",{value:"bachelor",children:"بكالوريوس"}),e.jsx("option",{value:"master",children:"ماجستير"}),e.jsx("option",{value:"phd",children:"دكتوراه"}),e.jsx("option",{value:"other",children:"أخرى"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"job",children:"الوظيفة الحالية"}),e.jsx("input",{type:"text",id:"job",name:"job",value:a.job,onChange:n,placeholder:"مثال: مهندس، طبيب، معلم"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"department",children:"القسم *"}),e.jsxs("select",{id:"department",name:"department",value:a.department,onChange:n,required:!0,children:[e.jsx("option",{value:"",children:"اختر القسم"}),e.jsx("option",{value:"education",children:"التعليم والتدريب"}),e.jsx("option",{value:"health",children:"الصحة والرعاية"}),e.jsx("option",{value:"social",children:"الشؤون الاجتماعية"}),e.jsx("option",{value:"finance",children:"المالية والمحاسبة"}),e.jsx("option",{value:"media",children:"الإعلام والتسويق"}),e.jsx("option",{value:"logistics",children:"اللوجستيات والتنظيم"}),e.jsx("option",{value:"it",children:"تقنية المعلومات"}),e.jsx("option",{value:"legal",children:"الشؤون القانونية"}),e.jsx("option",{value:"other",children:"أخرى"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"skills",children:"المهارات"}),e.jsx("input",{type:"text",id:"skills",name:"skills",value:a.skills,onChange:n,placeholder:"مثال: تصميم، برمجة، تدريس (مفصولة بفواصل)"})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{htmlFor:"experience",children:"الخبرات السابقة"}),e.jsx("textarea",{id:"experience",name:"experience",value:a.experience,onChange:n,rows:"3",placeholder:"اذكر خبراتك السابقة"})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>j(!1),children:[e.jsx(FaTimes,{}),"إلغاء"]}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx(FaCheck,{}),"إضافة المتطوع"]})]})]})]})})}),e.jsx(N,{children:L&&l&&e.jsx(i.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>o(!1),children:e.jsxs(i.div,{className:"modal-content volunteer-form-modal",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:[e.jsx(k,{}),"تعديل بيانات المتطوع"]}),e.jsx("button",{className:"close-btn",onClick:()=>o(!1),children:e.jsx(FaTimes,{})})]}),e.jsxs("form",{onSubmit:P,className:"volunteer-form",children:[e.jsx("div",{className:"form-grid",children:e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"البيانات الشخصية"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-name",children:"الاسم الكامل *"}),e.jsx("input",{type:"text",id:"edit-name",name:"name",value:a.name,onChange:n,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-email",children:"البريد الإلكتروني *"}),e.jsx("input",{type:"email",id:"edit-email",name:"email",value:a.email,onChange:n,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-phone",children:"رقم الهاتف *"}),e.jsx("input",{type:"tel",id:"edit-phone",name:"phone",value:a.phone,onChange:n,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-department",children:"القسم *"}),e.jsxs("select",{id:"edit-department",name:"department",value:a.department,onChange:n,required:!0,children:[e.jsx("option",{value:"",children:"اختر القسم"}),e.jsx("option",{value:"education",children:"التعليم والتدريب"}),e.jsx("option",{value:"health",children:"الصحة والرعاية"}),e.jsx("option",{value:"social",children:"الشؤون الاجتماعية"}),e.jsx("option",{value:"finance",children:"المالية والمحاسبة"}),e.jsx("option",{value:"media",children:"الإعلام والتسويق"}),e.jsx("option",{value:"logistics",children:"اللوجستيات والتنظيم"}),e.jsx("option",{value:"it",children:"تقنية المعلومات"}),e.jsx("option",{value:"legal",children:"الشؤون القانونية"}),e.jsx("option",{value:"other",children:"أخرى"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-skills",children:"المهارات"}),e.jsx("input",{type:"text",id:"edit-skills",name:"skills",value:a.skills,onChange:n})]})]})}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>o(!1),children:[e.jsx(FaTimes,{}),"إلغاء"]}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx(FaCheck,{}),"حفظ التغييرات"]})]})]})]})})})]})};export{Ce as default};
