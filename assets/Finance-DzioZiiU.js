import{j as e,m as n,A as C}from"./ui-4y8eivj0.js";import{r as l}from"./router-CLq98pCg.js";import{u as P,e as j}from"./redux-Bcoi-VAn.js";import{Q as W,R as L,S as M,H as R,T as b,U as S,V as Q,W as V,X,Y,Z,_,$ as B,a0 as z}from"./index-BA4kY8UC.js";import"./vendor-CWc6w16D.js";const se=()=>{const o=P(),[m,w]=l.useState(!1),[h,T]=l.useState(!1),[c,k]=l.useState({date:new Date().toISOString().split("T")[0],amount:"",type:"expense",description:"",beneficiaries:[]}),[s,r]=l.useState({amount:"",method:"cash",description:"",date:new Date().toISOString().split("T")[0]}),f=j(W),y=j(L);j(M);const v=j(R),[d,g]=l.useState([]),[p,U]=l.useState(!1);l.useEffect(()=>{o(b())},[f,o]);const N=()=>{w(!m),h&&T(!1),m||(k({date:new Date().toISOString().split("T")[0],amount:"",type:"expense",description:"",beneficiaries:[]}),g([]))},F=()=>{T(!h),m&&w(!1),h||r({amount:"",method:"cash",description:"",date:new Date().toISOString().split("T")[0]})},u=a=>{const{name:i,value:t}=a.target;r({...s,[i]:t})},x=a=>{const{name:i,value:t}=a.target;k({...c,[i]:t})},$=()=>{U(!p)},q=a=>{d.includes(a)?g(d.filter(i=>i!==a)):g([...d,a])},A=a=>{window.confirm("هل أنت متأكد من حذف هذه المعاملة؟")&&o(z(a)).unwrap().then(()=>{console.log("تم حذف المعاملة بنجاح"),o(b())}).catch(i=>{console.error("خطأ في حذف المعاملة:",i)})},E=a=>{a.preventDefault();const i={...c,amount:parseFloat(c.amount),beneficiaries:d.map(t=>{const D=v.find(O=>O.id===t);return{id:D.id,name:D.name}})};o(B(i)).unwrap().then(()=>{console.log("تمت إضافة المعاملة بنجاح"),o(b()),N()}).catch(t=>{console.error("خطأ في إضافة المعاملة:",t)})},H=a=>{a.preventDefault();const i={date:s.date,amount:parseFloat(s.amount),type:"income",description:`توب أب (${I(s.method)}): ${s.description}`,beneficiaries:[]};o(B(i)).unwrap().then(()=>{console.log("تم إضافة التوب أب بنجاح"),o(b()),F()}).catch(t=>{console.error("خطأ في إضافة التوب أب:",t)})},I=a=>{switch(a){case"cash":return"نقدي";case"card":return"بطاقة ائتمان";case"bank":return"تحويل بنكي";case"donation":return"تبرع";default:return a}};return e.jsxs(n.div,{className:"finance-container",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:"المالية"}),e.jsxs("div",{className:"header-actions",children:[e.jsx(n.button,{className:"btn btn-success",onClick:F,whileHover:{scale:1.05},whileTap:{scale:.95},children:h?"إلغاء":e.jsxs(e.Fragment,{children:[e.jsx(S,{})," توب أب"]})}),e.jsx(n.button,{className:"btn btn-primary",onClick:N,whileHover:{scale:1.05},whileTap:{scale:.95},children:m?"إلغاء":e.jsxs(e.Fragment,{children:[e.jsx(Q,{})," إضافة معاملة جديدة"]})})]})]}),e.jsxs("div",{className:"finance-summary",children:[e.jsxs(n.div,{className:"summary-card income-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:[e.jsx("h3",{children:"الإيرادات"}),e.jsxs("div",{className:"summary-amount",children:[y.totalIncome.toFixed(2)," جنيه مصري"]})]}),e.jsxs(n.div,{className:"summary-card expense-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[e.jsx("h3",{children:"المصروفات"}),e.jsxs("div",{className:"summary-amount",children:[y.totalExpenses.toFixed(2)," جنيه مصري"]})]}),e.jsxs(n.div,{className:"summary-card balance-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[e.jsx("h3",{children:"الرصيد"}),e.jsxs("div",{className:"summary-amount",children:[y.balance.toFixed(2)," جنيه مصري"]})]})]}),e.jsx(C,{children:h&&e.jsxs(n.div,{className:"add-form-container card top-up-form",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsx("h2",{children:"إضافة توب أب"}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topup-date",children:"التاريخ"}),e.jsx("input",{type:"date",id:"topup-date",name:"date",value:s.date,onChange:u,required:!0,autoComplete:"off","aria-label":"تاريخ التوب أب"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topup-amount",children:"المبلغ"}),e.jsx("input",{type:"number",id:"topup-amount",name:"amount",value:s.amount,onChange:u,required:!0,min:"0",step:"0.01",autoComplete:"off","aria-label":"مبلغ التوب أب",placeholder:"أدخل المبلغ"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topup-method",children:"طريقة الدفع"}),e.jsxs("select",{id:"topup-method",name:"method",value:s.method,onChange:u,required:!0,autoComplete:"off","aria-label":"اختر طريقة الدفع",children:[e.jsx("option",{value:"cash",children:"نقدي"}),e.jsx("option",{value:"card",children:"بطاقة ائتمان"}),e.jsx("option",{value:"bank",children:"تحويل بنكي"}),e.jsx("option",{value:"donation",children:"تبرع"})]}),e.jsxs("div",{className:"payment-method-icons",children:[e.jsxs("div",{className:`payment-method-icon ${s.method==="cash"?"active":""}`,onClick:()=>r({...s,method:"cash"}),children:[e.jsx(S,{}),e.jsx("span",{children:"نقدي"})]}),e.jsxs("div",{className:`payment-method-icon ${s.method==="card"?"active":""}`,onClick:()=>r({...s,method:"card"}),children:[e.jsx(V,{}),e.jsx("span",{children:"بطاقة ائتمان"})]}),e.jsxs("div",{className:`payment-method-icon ${s.method==="bank"?"active":""}`,onClick:()=>r({...s,method:"bank"}),children:[e.jsx(X,{}),e.jsx("span",{children:"تحويل بنكي"})]}),e.jsxs("div",{className:`payment-method-icon ${s.method==="donation"?"active":""}`,onClick:()=>r({...s,method:"donation"}),children:[e.jsx(Y,{}),e.jsx("span",{children:"تبرع"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topup-description",children:"الوصف"}),e.jsx("textarea",{id:"topup-description",name:"description",value:s.description,onChange:u,required:!0,placeholder:"أدخل وصفًا للتوب أب أو اسم المتبرع",autoComplete:"off","aria-label":"وصف التوب أب",rows:"3"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"submit",className:"btn btn-success",children:[e.jsx(S,{})," إضافة التوب أب"]}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:F,children:"إلغاء"})]})]})]})}),e.jsx(C,{children:m&&e.jsxs(n.div,{className:"add-form-container card",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsx("h2",{children:"إضافة معاملة جديدة"}),e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"date",children:"التاريخ"}),e.jsx("input",{type:"date",id:"date",name:"date",value:c.date,onChange:x,required:!0,autoComplete:"off","aria-label":"تاريخ المعاملة"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"type",children:"نوع المعاملة"}),e.jsxs("select",{id:"type",name:"type",value:c.type,onChange:x,required:!0,autoComplete:"off","aria-label":"اختر نوع المعاملة",children:[e.jsx("option",{value:"income",children:"إيراد"}),e.jsx("option",{value:"expense",children:"مصروف"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"amount",children:"المبلغ"}),e.jsx("input",{type:"number",id:"amount",name:"amount",value:c.amount,onChange:x,required:!0,min:"0",step:"0.01",autoComplete:"off","aria-label":"مبلغ المعاملة",placeholder:"أدخل المبلغ"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description",children:"الوصف"}),e.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:x,required:!0,autoComplete:"off","aria-label":"وصف المعاملة",placeholder:"أدخل وصف المعاملة",rows:"3"})]}),c.type==="expense"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"المستفيدين"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:$,"aria-label":"إضافة أو إخفاء قائمة المستفيدين","aria-expanded":p,children:p?"إخفاء المستفيدين":"إضافة مستفيدين"}),e.jsx(C,{children:p&&e.jsxs(n.div,{className:"beneficiaries-selection",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[v.length>0?e.jsx("div",{className:"beneficiaries-list",children:v.map(a=>e.jsxs("div",{className:"beneficiary-checkbox",children:[e.jsx("input",{type:"checkbox",id:`beneficiary-${a.id}`,checked:d.includes(a.id),onChange:()=>q(a.id)}),e.jsx("label",{htmlFor:`beneficiary-${a.id}`,children:a.name})]},a.id))}):e.jsx("div",{className:"no-beneficiaries",children:"لا يوجد مستفيدين متاحين"}),e.jsxs("div",{className:"selected-count",children:["تم اختيار ",d.length," مستفيد"]})]})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",children:"حفظ"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:N,children:"إلغاء"})]})]})]})}),e.jsx("div",{className:"transactions-list",children:f.length>0?f.map(a=>e.jsxs(n.div,{className:"transaction-card card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"transaction-header",children:[e.jsx("h3",{children:a.type==="income"?"إيراد":"مصروف"}),e.jsx("span",{className:"transaction-date",children:a.date})]}),e.jsx("div",{className:"transaction-amount",children:e.jsxs("span",{className:a.type==="income"?"income-amount":"expense-amount",children:[parseFloat(a.amount).toFixed(2)," جنيه مصري"]})}),e.jsx("div",{className:"transaction-description",children:a.description}),a.type==="expense"&&a.beneficiaries.length>0&&e.jsxs("div",{className:"transaction-beneficiaries-container",children:[e.jsxs("button",{className:"show-beneficiaries-btn",onClick:i=>{i.currentTarget.parentNode.classList.toggle("show-details")},children:["عرض المستفيدين (",a.beneficiaries.length,")"]}),e.jsx("div",{className:"transaction-beneficiaries",children:e.jsx("ul",{children:a.beneficiaries.map(i=>{const t=(parseFloat(a.amount)/a.beneficiaries.length).toFixed(2);return e.jsxs("li",{children:[e.jsx("span",{className:"beneficiary-name",children:i.name}),e.jsxs("span",{className:"beneficiary-amount",children:[t," جنيه"]})]},i.id)})})})]}),e.jsxs("div",{className:"transaction-actions",children:[e.jsx("button",{className:"btn-icon edit-btn",title:"تعديل المعاملة",onClick:()=>console.log("تعديل المعاملة",a.id),children:e.jsx(Z,{})}),e.jsx("button",{className:"btn-icon delete-btn",title:"حذف المعاملة",onClick:()=>A(a.id),children:e.jsx(_,{})})]})]},a.id)):e.jsx("div",{className:"no-transactions",children:"لا توجد معاملات مالية"})})]})};export{se as default};
